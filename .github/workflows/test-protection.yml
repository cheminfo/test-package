name: Test branch protection rules

on:
  pull_request:

jobs:
  prepare:
    runs-on: ubuntu-latest
    outputs:
      changes: ${{ steps.changes.outputs.changes }}
    steps:
      - uses: actions/checkout@v4
      - uses: dorny/paths-filter@v3
        id: changes
        with:
          filters: .github/filters.yaml
  test1:
    needs: prepare
    if: ${{ contains(fromJSON(needs.prepare.outputs.changes), 'test1') }}
    runs-on: ubuntu-latest
    steps:
      - run: echo "Test 1 passed"
  test2:
    needs: prepare
    if: ${{ contains(fromJSON(needs.prepare.outputs.changes), 'test2') }}
    runs-on: ubuntu-latest
    steps:
      - run: echo "Test 2 passed"
